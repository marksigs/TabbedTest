<?xml version="1.0" encoding="UTF-8"?>
<!--==============================XML Document Control=============================

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Workfile				$Workfile: FindIntroducersWSSchema.xml $
Current Version:	$Revision: 10 $
Last Modified:		$JustDate: 26/03/07 $
Modified By:			$Author: Lesliem $
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

History:

Author		Date				Defect		Description
IK				23/10/2006  	EP2_21	created for Epsom FindIntroducersWS
IK				27/10/2006	EP2_21	fix for FSAREFERENCENUMBER
IK				09/11/2006	EP2_35	add FSAINDIVIDUAL
IK				14/11/2006	EP2_89	add PACKAGERIND to MORTGAGECLUBNETWORKASSOCIATION
IK				17/11/2006	EP2_113	remove TOTALRECS from FSAINDIVIDUAL 
IK				22/11/2006	EP2_160	return Packager Association with PRINCIPALFIRM
IK				05/01/2007	EP2_383	backed-out
IK				08/01/2007	EP2_714	changes to INDIVIDUALCONTROLS & INDIVIDUALEMPLOYMENT
IK				01/02/2007	EP2_338 - FIRMPERMISSIONS via view uvw_FirmPermissionsDescribed
PSC         08/03/2007 EP2_1190 - Amend ARFIRM as the stored proc now returns xml
================================================================================-->
<OM_SCHEMA BOOLEANTRUE="true" BOOLEANFALSE="false">
	<ENTITY ENTITY_REF="ARFIRM" READ_PROC="xml:Usp_EpsomWS_FindARFirm">
		<ATTRIBUTE NAME="ARFIRMID" ENTITY_REF="ARFIRM" READPARAM="IN"/>
		<ATTRIBUTE NAME="FSAREFERENCENUMBER" DATATYPE="STRING" LENGTH="12" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="ARFIRMNAME" ENTITY_REF="ARFIRM" READPARAM="IN"/>
		<ATTRIBUTE NAME="TOWN" DATATYPE="STRING" LENGTH="50" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="POSTCODE" ENTITY_REF="ARFIRM" READPARAM="IN"/>
		<ATTRIBUTE NAME="ALLPARENTPRINCIPALS" DATATYPE="SHORT"  READPARAM="IN"/>
		<ATTRIBUTE NAME="MORTGAGENETWORKS" DATATYPE="SHORT"  READPARAM="IN"/>
		<ATTRIBUTE NAME="SELECTEDNETWORK" DATATYPE="SHORT"  READPARAM="IN"/>
	</ENTITY>
	<ENTITY ENTITY_REF="PRINCIPALFIRM" READ_PROC="usp_EpsomWS_FindPrincipalFirm">
		<ATTRIBUTE NAME="PRINCIPALFIRMID" ENTITY_REF="PRINCIPALFIRM" READPARAM="IN"/>
		<ATTRIBUTE NAME="FSAREFERENCENUMBER" DATATYPE="STRING" LENGTH="12" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="PRINCIPALFIRMNAME" ENTITY_REF="PRINCIPALFIRM" READPARAM="IN"/>
		<ATTRIBUTE NAME="TOWN" DATATYPE="STRING" LENGTH="50" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="POSTCODE" ENTITY_REF="PRINCIPALFIRM" READPARAM="IN"/>
		<ATTRIBUTE NAME="PACKAGERIND" DATATYPE="SHORT" READPARAM="IN" DATAMAP="NO"/>
		<ENTITY ENTITY_REF="FIRMPERMISSIONS" READ_REF="uvw_FirmPermissionsDescribed">
			<ATTRIBUTE NAME="FIRMPERMISSIONSSEQNO" ENTITY_REF="FIRMPERMISSIONS" KEYTYPE="NULL"/>
			<ATTRIBUTE NAME="PRINCIPALFIRMID" ENTITY_REF="FIRMPERMISSIONS" KEYTYPE="FOREIGN"/>
			<ATTRIBUTE NAME="ACTIVITYDESCRIPTION" ENTITY_REF="ACTIVITYFSA"/>
			<ATTRIBUTE NAME="CATEGORY" ENTITY_REF="ACTIVITYFSA"/>
		</ENTITY>
		<ENTITY ENTITY_REF="FIRMCLUBNETWORKASSOCIATION" >
			<ATTRIBUTE NAME="FIRMCLUBSEQNO" ENTITY_REF="FIRMCLUBNETWORKASSOCIATION" KEYTYPE="NULL"/>
			<ATTRIBUTE NAME="PRINCIPALFIRMID" ENTITY_REF="FIRMCLUBNETWORKASSOCIATION" KEYTYPE="FOREIGN"/>
			<ENTITY ENTITY_REF="base:MORTGAGECLUBNETWORKASSOCIATION" />
		</ENTITY>
	</ENTITY>
	<ENTITY NAME="MORTGAGECLUBNETWORKASSOCIATION" ENTITY_REF="MORTGAGECLUBNETWORKASSOCIATION" READ_PROC="xml:Usp_EpsomWS_FindMortgageClub">
		<ATTRIBUTE NAME="CLUBNETWORKASSOCIATIONID" DATATYPE="STRING" LENGTH="12" READPARAM="IN"/>
		<ATTRIBUTE NAME="PRINCIPALFIRMID" ENTITY_REF="PRINCIPALFIRM" READPARAM="IN"/>
		<ATTRIBUTE NAME="FSAREFERENCENUMBER" DATATYPE="STRING" LENGTH="12" READPARAM="IN"/>
		<ATTRIBUTE NAME="COMPANYNAME" DATATYPE="STRING" LENGTH="130" READPARAM="IN"/>
		<ATTRIBUTE NAME="TOWN" DATATYPE="STRING" LENGTH="50" READPARAM="IN"/>
		<ATTRIBUTE NAME="POSTCODE" ENTITY_REF="PRINCIPALFIRM" READPARAM="IN"/>
		<ATTRIBUTE NAME="PACKAGERIND" DATATYPE="SHORT" READPARAM="IN"/>
	</ENTITY>
	<ENTITY NAME="INTRODUCERDETAILS" ENTITY_REF="INTRODUCER" READ_PROC="Usp_EpsomWS_FindIntroducer">
		<ATTRIBUTE NAME="BROKERTYPE" DATATYPE="STRING" LENGTH="2" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="PRINCIPALFIRMID" ENTITY_REF="PRINCIPALFIRM" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="FSAREFERENCENUMBER" DATATYPE="STRING" LENGTH="12" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="COMPANYNAME" DATATYPE="STRING" LENGTH="130" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="TOWN" ENTITY_REF="INTRODUCER" READPARAM="IN"/>
		<ATTRIBUTE NAME="POSTCODE" ENTITY_REF="INTRODUCER" READPARAM="IN"/>
		<ENTITY ENTITY_REF="INTRODUCERFIRM">
			<ATTRIBUTE NAME="INTRODUCERFIRMSEQNO" KEYTYPE="NULL"/>
			<ATTRIBUTE NAME="INTRODUCERID" KEYTYPE="FOREIGN"/>
			<ENTITY ENTITY_REF="PRINCIPALFIRM">
				<ATTRIBUTE NAME="POSTCODE" ENTITY_REF="PRINCIPALFIRM" NOREADVALUE="true"/>
			</ENTITY>
		</ENTITY>
		<ENTITY NAME="ORGANISATIONUSER" READ_REF="ORGANISATIONUSER">
			<ATTRIBUTE NAME="USERID" DATATYPE="STRING" LENGTH="64" GETDEFAULT="xpath:../@USERID"/>
			<ATTRIBUTE NAME="USERFORENAME" DATATYPE="STRING" LENGTH="30"/>
			<ATTRIBUTE NAME="USERINITIALS" DATATYPE="STRING" LENGTH="3"/>
			<ATTRIBUTE NAME="USERSURNAME" DATATYPE="STRING" LENGTH="35"/>
			<ATTRIBUTE NAME="USERTITLE" DATATYPE="COMBO" COMBOGROUP="ContactTitle"/>
			<ENTITY ENTITY_REF="ORGANISATIONUSERCONTACTDETAILS">
				<ATTRIBUTE NAME="USERID" DATATYPE="STRING" LENGTH="64" GETDEFAULT="xpath:../@USERID"/>
				<ENTITY ENTITY_REF="CONTACTDETAILS">
					<ENTITY ENTITY_REF="CONTACTTELEPHONEDETAILS"/>
				</ENTITY>
			</ENTITY>
		</ENTITY>
	</ENTITY>
	<ENTITY NAME="FSAINDIVIDUAL" ENTITY_REF="INDIVIDUALBASICS" READ_PROC="usp_EpsomWS_FindFsaIndividual">
		<ATTRIBUTE NAME="INDIVIDUALFSAREF" DATATYPE="STRING" LENGTH="12" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="INDIVIDUALSURNAME" DATATYPE="STRING" LENGTH="70" READPARAM="IN" DATAMAP="NO"/>
		<ATTRIBUTE NAME="INDIVIDUALFORENAME" DATATYPE="STRING" LENGTH="70" READPARAM="IN" DATAMAP="NO"/>
		<ENTITY ENTITY_REF="INDIVIDUALCONTROLS">
			<ATTRIBUTE NAME="FSAINDIVIDUALREF" ENTITY_REF="INDIVIDUALCONTROLS" KEYTYPE="FOREIGN"/>
			<ENTITY ENTITY_REF="base:PRINCIPALFIRM"/>
		</ENTITY>
		<ENTITY ENTITY_REF="INDIVIDUALEMPLOYMENT">
			<ATTRIBUTE NAME="FSAINDIVIDUALREF" ENTITY_REF="INDIVIDUALEMPLOYMENT" KEYTYPE="FOREIGN"/>
			<ENTITY ENTITY_REF="base:ARFIRM"/>
		</ENTITY>
	</ENTITY>
</OM_SCHEMA>
