VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "DisbursementpaymentTable"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Class         :   DisbursementpaymentTable
' Description   :   Contains all access functions for the Disbursementpayment table.
' Change history
' Prog     Date         Description
' TW       27/11/2007   Generated by Supervisor Class Generator
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Option Explicit
Implements TableAccess

'Private data
Private m_clsTableAccess As TableAccess
Private m_sSearch As String

' Local constants
Private Const m_sTableName = "Disbursementpayment"
Private Const DELETE_FLAG_SET As Integer = 1

' Field Name constants
Private Const ApplicationNumber As String = "APPLICATIONNUMBER"
Private Const PAYMENTSEQUENCENUMBER As String = "PAYMENTSEQUENCENUMBER"
Private Const PAYMENTSTATUS As String = "PAYMENTSTATUS"
Private Const PROCESSINGDATE As String = "PROCESSINGDATE"
Private Const COMPLETIONDATE As String = "COMPLETIONDATE"
Private Const CANCELLATIONDATE As String = "CANCELLATIONDATE"
Private Const MANUALPAYMENTINDICATOR As String = "MANUALPAYMENTINDICATOR"
Private Const TTREFNUMBER1 As String = "TTREFNUMBER1"
Private Const TTREFNUMBER2 As String = "TTREFNUMBER2"
Private Const PAYMENTNOTES As String = "PAYMENTNOTES"
Private Const ISSUEDATE As String = "ISSUEDATE"
Private Const PAYMENTTYPE As String = "PAYMENTTYPE"
Private Const PAYEEHISTORYSEQNO As String = "PAYEEHISTORYSEQNO"
Private Const PAYEETYPE As String = "PAYEETYPE"
Private Const NETPAYMENTAMOUNT As String = "NETPAYMENTAMOUNT"
Private Const SHORTFALL As String = "SHORTFALL"
Private Const TOTALMONTHLYCOST As String = "TOTALMONTHLYCOST"
Private Const TOTALACCRUEDINTEREST As String = "TOTALACCRUEDINTEREST"
Private Const DELAYEDCOMPLETION As String = "DELAYEDCOMPLETION"
Private Const FIRSTPAYMENTDATE As String = "FIRSTPAYMENTDATE"
Private Const FIRSTPAYMENT As String = "FIRSTPAYMENT"
Private Const REGULARPAYMENT As String = "REGULARPAYMENT"
Private Const EXCLUDEFROMAUTOCOMPLETIONIND As String = "EXCLUDEFROMAUTOCOMPLETIONIND"
Private Const MANUALINTERFACEIND As String = "MANUALINTERFACEIND"
Private Const CompletionModifiedBy As String = "COMPLETIONMODIFIEDBY"
Private Const CompletionModifiedDateTime As String = "COMPLETIONMODIFIEDDATETIME"


Private m_sFirstMatch As String

Public Sub GetPaymentsForCompletion()

Dim sSQL As String
Dim rs As ADODB.Recordset
On Error GoTo Failed
    
 
' Read all DisbursementPayment records where PaymentStatus = "Paid"
' OR = "Interface Failed" (combo "PaymentStatus" ValidationType = "P" OR = "IF").

    sSQL = "SELECT DP.APPLICATIONNUMBER, NETPAYMENTAMOUNT, " & _
           " PAYMENTSEQUENCENUMBER, CV2.VALUENAME AS PAYMENTTYPE, " & _
           " CV1B.VALUENAME AS PAYMENTSTATUS, CV3.VALUENAME AS APPLICATIONTYPE, " & _
           " EXCLUDE = " & _
           " CASE EXCLUDEFROMAUTOCOMPLETIONIND " & _
           " WHEN '1' THEN 'Yes' " & _
           " ELSE '' " & _
           " END, " & _
           " MANUAL = " & _
           " CASE MANUALINTERFACEIND " & _
           " WHEN '1' THEN 'Yes' " & _
           " ELSE '' " & _
           " END "
    sSQL = sSQL & _
           " FROM " & m_sTableName & " DP " & _
           " INNER JOIN APPLICATIONFACTFIND AF " & _
           " ON DP.APPLICATIONNUMBER = AF.APPLICATIONNUMBER " & _
           " INNER JOIN COMBOVALIDATION CV1A " & _
           " ON DP.PAYMENTSTATUS = CV1A.VALUEID " & _
           " INNER JOIN COMBOVALUE CV1B " & _
           " ON DP.PAYMENTSTATUS = CV1B.VALUEID " & _
           " INNER JOIN COMBOVALUE CV2 " & _
           " ON DP.PAYMENTTYPE = CV2.VALUEID " & _
           " INNER JOIN COMBOVALUE CV3 " & _
           " ON AF.TYPEOFAPPLICATION = CV3.VALUEID " & _
           " WHERE CV1A.GROUPNAME = 'PaymentStatus' " & _
           " AND CV1A.VALIDATIONTYPE IN ('P', 'IF') " & _
           " AND CV1B.GROUPNAME = 'PaymentStatus' " & _
           " AND CV2.GROUPNAME = 'PaymentType' " & _
           " AND CV3.GROUPNAME = 'TypeOfMortgage'"

    Set rs = g_clsDataAccess.GetTableData(m_sTableName, sSQL)
    
    ValidateRecordset rs, "PaymentsForCompletion"
    m_clsTableAccess.SetRecordSet rs
    
    Exit Sub
Failed:
    g_clsErrorHandling.RaiseError Err.Number, Err.DESCRIPTION
End Sub


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Function      :   Class_Initialize
' Description   :   VB Calls this method when the class is created. Do any initialisation here
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Private Sub Class_Initialize()
    Dim colFields As New Collection

    Set m_clsTableAccess = New TableAccess
    
    m_clsTableAccess.Create m_sTableName
    
    ' Key fields
   colFields.Add ApplicationNumber
   colFields.Add PAYMENTSEQUENCENUMBER

    m_clsTableAccess.SetKeyMatchFields colFields

    ' Order criteria used when executing queries

End Sub

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Get Access Functions
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Friend Function GetApplicationNumber() As String
    GetApplicationNumber = CStr(m_clsTableAccess.GetVal(ApplicationNumber))
End Function
Friend Function GetPaymentsequencenumber() As String
    GetPaymentsequencenumber = CStr(m_clsTableAccess.GetVal(PAYMENTSEQUENCENUMBER))
End Function
Friend Function GetApplicationType() As String
    GetApplicationType = CStr(m_clsTableAccess.GetVal("ApplicationType"))
End Function
Friend Function GetPaymentstatus() As String
    GetPaymentstatus = CStr(m_clsTableAccess.GetVal(PAYMENTSTATUS))
End Function

Friend Function GetProcessingdate() As String
    GetProcessingdate = CStr(m_clsTableAccess.GetVal(PROCESSINGDATE))
End Function
Friend Function GetCompletiondate() As String
    GetCompletiondate = CStr(m_clsTableAccess.GetVal(COMPLETIONDATE))
End Function
Friend Function GetCancellationdate() As String
    GetCancellationdate = CStr(m_clsTableAccess.GetVal(CANCELLATIONDATE))
End Function
Friend Function GetManualpaymentindicator() As String
    GetManualpaymentindicator = CStr(m_clsTableAccess.GetVal(MANUALPAYMENTINDICATOR))
End Function
Friend Function GetTtrefnumber1() As String
    GetTtrefnumber1 = CStr(m_clsTableAccess.GetVal(TTREFNUMBER1))
End Function
Friend Function GetTtrefnumber2() As String
    GetTtrefnumber2 = CStr(m_clsTableAccess.GetVal(TTREFNUMBER2))
End Function
Friend Function GetPaymentnotes() As String
    GetPaymentnotes = CStr(m_clsTableAccess.GetVal(PAYMENTNOTES))
End Function
Friend Function GetIssueDate() As String
    GetIssueDate = CStr(m_clsTableAccess.GetVal(ISSUEDATE))
End Function
Friend Function GetPaymenttype() As String
    GetPaymenttype = CStr(m_clsTableAccess.GetVal(PAYMENTTYPE))
End Function
Friend Function GetPayeehistoryseqno() As String
    GetPayeehistoryseqno = CStr(m_clsTableAccess.GetVal(PAYEEHISTORYSEQNO))
End Function
Friend Function GetPayeetype() As String
    GetPayeetype = CStr(m_clsTableAccess.GetVal(PAYEETYPE))
End Function
Friend Function GetNetpaymentamount() As String
    GetNetpaymentamount = CStr(m_clsTableAccess.GetVal(NETPAYMENTAMOUNT))
End Function
Friend Function GetShortfall() As String
    GetShortfall = CStr(m_clsTableAccess.GetVal(SHORTFALL))
End Function
Friend Function GetTotalmonthlycost() As String
    GetTotalmonthlycost = CStr(m_clsTableAccess.GetVal(TOTALMONTHLYCOST))
End Function
Friend Function GetTotalaccruedinterest() As String
    GetTotalaccruedinterest = CStr(m_clsTableAccess.GetVal(TOTALACCRUEDINTEREST))
End Function
Friend Function GetDelayedcompletion() As String
    GetDelayedcompletion = CStr(m_clsTableAccess.GetVal(DELAYEDCOMPLETION))
End Function
Friend Function GetFirstpaymentdate() As String
    GetFirstpaymentdate = CStr(m_clsTableAccess.GetVal(FIRSTPAYMENTDATE))
End Function
Friend Function GetFirstpayment() As String
    GetFirstpayment = CStr(m_clsTableAccess.GetVal(FIRSTPAYMENT))
End Function
Friend Function GetRegularpayment() As String
    GetRegularpayment = CStr(m_clsTableAccess.GetVal(REGULARPAYMENT))
End Function
Friend Function GetExclude() As String
    GetExclude = CStr(m_clsTableAccess.GetVal("EXCLUDE"))
End Function
Friend Function GetExcludefromautocompletionind() As String
    GetExcludefromautocompletionind = CStr(m_clsTableAccess.GetVal(EXCLUDEFROMAUTOCOMPLETIONIND))
End Function

Friend Function GetManual() As String
    GetManual = CStr(m_clsTableAccess.GetVal("MANUAL"))
End Function
Friend Function GetManualinterfaceind() As String
    GetManualinterfaceind = CStr(m_clsTableAccess.GetVal(MANUALINTERFACEIND))
End Function

Friend Function GetCompletionmodifiedby() As String
    GetCompletionmodifiedby = CStr(m_clsTableAccess.GetVal(CompletionModifiedBy))
End Function
Friend Function GetCompletionmodifieddatetime() As String
    GetCompletionmodifieddatetime = Format$(m_clsTableAccess.GetVal(CompletionModifiedDateTime), "dd/mm/yy hh:nn:ss")
End Function

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Set Access Functions
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Friend Function SetApplicationNumber(sValue As Variant) As Boolean
    SetApplicationNumber = m_clsTableAccess.SetVal(ApplicationNumber, CVar(sValue))
End Function
Friend Function SetPaymentsequencenumber(sValue As Variant) As Boolean
    SetPaymentsequencenumber = m_clsTableAccess.SetVal(PAYMENTSEQUENCENUMBER, CVar(sValue))
End Function
Friend Function SetPaymentstatus(sValue As Variant) As Boolean
    SetPaymentstatus = m_clsTableAccess.SetVal(PAYMENTSTATUS, CVar(sValue))
End Function
Friend Function SetProcessingdate(sValue As Variant) As Boolean
    SetProcessingdate = m_clsTableAccess.SetVal(PROCESSINGDATE, CVar(sValue))
End Function
Friend Function SetCompletionDate(sValue As Variant) As Boolean
    SetCompletionDate = m_clsTableAccess.SetVal(COMPLETIONDATE, CVar(sValue))
End Function
Friend Function SetCancellationdate(sValue As Variant) As Boolean
    SetCancellationdate = m_clsTableAccess.SetVal(CANCELLATIONDATE, CVar(sValue))
End Function
Friend Function SetManualpaymentindicator(sValue As Variant) As Boolean
    SetManualpaymentindicator = m_clsTableAccess.SetVal(MANUALPAYMENTINDICATOR, CVar(sValue))
End Function
Friend Function SetTtrefnumber1(sValue As Variant) As Boolean
    SetTtrefnumber1 = m_clsTableAccess.SetVal(TTREFNUMBER1, CVar(sValue))
End Function
Friend Function SetTtrefnumber2(sValue As Variant) As Boolean
    SetTtrefnumber2 = m_clsTableAccess.SetVal(TTREFNUMBER2, CVar(sValue))
End Function
Friend Function SetPaymentnotes(sValue As Variant) As Boolean
    SetPaymentnotes = m_clsTableAccess.SetVal(PAYMENTNOTES, CVar(sValue))
End Function
Friend Function SetIssueDate(sValue As Variant) As Boolean
    SetIssueDate = m_clsTableAccess.SetVal(ISSUEDATE, CVar(sValue))
End Function
Friend Function SetPaymentType(sValue As Variant) As Boolean
    SetPaymentType = m_clsTableAccess.SetVal(PAYMENTTYPE, CVar(sValue))
End Function
Friend Function SetPayeehistoryseqno(sValue As Variant) As Boolean
    SetPayeehistoryseqno = m_clsTableAccess.SetVal(PAYEEHISTORYSEQNO, CVar(sValue))
End Function
Friend Function SetPayeetype(sValue As Variant) As Boolean
    SetPayeetype = m_clsTableAccess.SetVal(PAYEETYPE, CVar(sValue))
End Function
Friend Function SetNetpaymentamount(sValue As Variant) As Boolean
    SetNetpaymentamount = m_clsTableAccess.SetVal(NETPAYMENTAMOUNT, CVar(sValue))
End Function
Friend Function SetShortfall(sValue As Variant) As Boolean
    SetShortfall = m_clsTableAccess.SetVal(SHORTFALL, CVar(sValue))
End Function
Friend Function SetTotalmonthlycost(sValue As Variant) As Boolean
    SetTotalmonthlycost = m_clsTableAccess.SetVal(TOTALMONTHLYCOST, CVar(sValue))
End Function
Friend Function SetTotalaccruedinterest(sValue As Variant) As Boolean
    SetTotalaccruedinterest = m_clsTableAccess.SetVal(TOTALACCRUEDINTEREST, CVar(sValue))
End Function
Friend Function SetDelayedcompletion(sValue As Variant) As Boolean
    SetDelayedcompletion = m_clsTableAccess.SetVal(DELAYEDCOMPLETION, CVar(sValue))
End Function
Friend Function SetFirstpaymentdate(sValue As Variant) As Boolean
    SetFirstpaymentdate = m_clsTableAccess.SetVal(FIRSTPAYMENTDATE, CVar(sValue))
End Function
Friend Function SetFirstpayment(sValue As Variant) As Boolean
    SetFirstpayment = m_clsTableAccess.SetVal(FIRSTPAYMENT, CVar(sValue))
End Function
Friend Function SetRegularpayment(sValue As Variant) As Boolean
    SetRegularpayment = m_clsTableAccess.SetVal(REGULARPAYMENT, CVar(sValue))
End Function
Friend Function SetExcludefromautocompletionind(sValue As Variant) As Boolean
    SetExcludefromautocompletionind = m_clsTableAccess.SetVal(EXCLUDEFROMAUTOCOMPLETIONIND, CVar(sValue))
End Function
Friend Function SetManualinterfaceind(sValue As Variant) As Boolean
    SetManualinterfaceind = m_clsTableAccess.SetVal(MANUALINTERFACEIND, CVar(sValue))
End Function
Friend Function SetCompletionmodifiedby(sValue As Variant) As Boolean
    SetCompletionmodifiedby = m_clsTableAccess.SetVal(CompletionModifiedBy, CVar(sValue))
End Function
Friend Function SetCompletionmodifieddatetime(sValue As Variant) As Boolean
    SetCompletionmodifieddatetime = m_clsTableAccess.SetVal(CompletionModifiedDateTime, CVar(sValue))
End Function

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' General Access Functions
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

Private Function TableAccess_DoesRecordExist(colMatchData As Collection, Optional colMatchFields As Collection) As Boolean
    TableAccess_DoesRecordExist = m_clsTableAccess.DoesRecordExist(colMatchData, colMatchFields)
End Function

'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' Implements Table Access Functions
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Private Function TableAccess_GetIsDeleted() As Boolean
    TableAccess_GetIsDeleted = m_clsTableAccess.GetIsDeleted()
End Function

Private Sub TableAccess_SetDeleteFields(colFields As Collection)
    m_clsTableAccess.SetDeleteFields colFields
End Sub

Private Sub TableAccess_GetTableDataFromSearch(sSearch As String, Optional bUseExistingSearch As Boolean = False)
    m_clsTableAccess.GetTableDataFromSearch sSearch
End Sub

Private Function TableAccess_GetLength(sField As String) As Integer
    TableAccess_GetLength = m_clsTableAccess.GetLength(sField)
End Function

Private Sub TableAccess_AddRow()
    m_clsTableAccess.AddRow
End Sub

Private Sub TableAccess_CloseRecordSet()
    m_clsTableAccess.CloseRecordSet
End Sub

Private Sub TableAccess_DeleteAllRows()
    m_clsTableAccess.DeleteAllRows
End Sub

Private Sub TableAccess_DeleteRow(colMatchData As Collection)
    m_clsTableAccess.DeleteRow colMatchData
End Sub

Private Function TableAccess_GetDate(sField As String, Optional ctrl As Object = Nothing, Optional ctrlLabel As Object = Nothing, Optional bCheck As Boolean = True, Optional bGetTime As Boolean = False) As Variant
    TableAccess_GetDate = m_clsTableAccess.GetDate(sField)
End Function

Private Function TableAccess_GetKeyMatchFields()
    Set TableAccess_GetKeyMatchFields = m_clsTableAccess.GetKeyMatchFields()
End Function

Private Function TableAccess_GetKeyMatchValues() As Variant
    Set TableAccess_GetKeyMatchValues = m_clsTableAccess.GetKeyMatchValues()
End Function

Private Function TableAccess_GetRecordSet() As ADODB.Recordset
    Set TableAccess_GetRecordSet = m_clsTableAccess.GetRecordSet()
End Function

Private Function TableAccess_GetTableData(Optional enumPopulateType As PopulateType = POPULATE_KEYS, Optional enumClassOption As ClassOption) As ADODB.Recordset
    Set TableAccess_GetTableData = m_clsTableAccess.GetTableData(enumPopulateType)
End Function

Private Function TableAccess_GetUpdated() As Boolean
    TableAccess_GetUpdated = m_clsTableAccess.GetUpdated()
End Function

Private Function TableAccess_GetVal(sField As Variant) As Variant
    TableAccess_GetVal = m_clsTableAccess.GetVal(sField)
End Function

Private Sub TableAccess_ValidateData(Optional sDesc As String = "")
        m_clsTableAccess.ValidateData sDesc
End Sub

Private Function TableAccess_MatchRecords(colFields As Collection, colMatchData As Collection) As ADODB.Recordset
    Set TableAccess_MatchRecords = m_clsTableAccess.MatchRecords(colFields, colMatchData)
End Function

Private Sub TableAccess_MoveFirst()
    m_clsTableAccess.MoveFirst
End Sub

Private Function TableAccess_MoveNext() As Boolean
    TableAccess_MoveNext = m_clsTableAccess.MoveNext()
End Function

Private Function TableAccess_RecordCount() As Integer
    TableAccess_RecordCount = m_clsTableAccess.RecordCount()
End Function

Private Function TableAccess_SetDate(sField As String, vval As Variant) As Boolean
    TableAccess_SetDate = m_clsTableAccess.SetDate(sField, vval)
End Function

Private Sub TableAccess_SetKeyMatchFields(colFields As Collection)
    m_clsTableAccess.SetKeyMatchFields colFields
End Sub

Private Sub TableAccess_SetKeyMatchValues(colValues As Collection)
    m_clsTableAccess.SetKeyMatchValues colValues
End Sub

Private Function TableAccess_SetNextRow() As Boolean
    TableAccess_SetNextRow = m_clsTableAccess.SetNextRow()
End Function

Private Sub TableAccess_SetPopulateType(enumType As PopulateType)
    
End Sub

Private Sub TableAccess_SetRecordSet(rs As ADODB.Recordset)
    m_clsTableAccess.SetRecordSet rs
End Sub

Private Sub TableAccess_SetUpdated()
    m_clsTableAccess.SetUpdated
End Sub

Private Function TableAccess_SetVal(sField As Variant, vval As Variant) As Boolean
    TableAccess_SetVal = m_clsTableAccess.SetVal(sField, vval)
End Function

Private Sub TableAccess_Update()
    m_clsTableAccess.Update
End Sub

Private Sub TableAccess_SetPopulateNull()
    m_clsTableAccess.SetPopulateNull
End Sub

Private Function TableAccess_GetSearch() As String
    TableAccess_GetSearch = m_sSearch
End Function

Private Function TableAccess_GetTable() As String
    TableAccess_GetTable = m_sTableName
End Function

Public Function TableAccess_GetUpdateValues() As Collection

End Function

Public Function TableAccess_GetUpdateFields() As Collection

End Function

Public Sub TableAccess_Create(sTable As String, Optional sFirstMatch As String = "")
    m_clsTableAccess.Create sTable, sFirstMatch
End Sub

Public Sub TableAccess_GetRowOfData(colListLine As Collection, Optional bIncludeHeader As Boolean = True)
' Please comment out or delete unwanted fields
    colListLine.Add GetApplicationNumber()
    colListLine.Add GetNetpaymentamount()
    colListLine.Add GetPaymentsequencenumber()
    colListLine.Add GetPaymenttype()
    colListLine.Add GetPaymentstatus()
    colListLine.Add GetApplicationType()
    colListLine.Add GetExclude()
    colListLine.Add GetManual()

End Sub

Public Sub TableAccess_SetTableClass(clsTable As TableAccess)
    Set m_clsTableAccess = clsTable
End Sub

Public Sub TableAccess_DeleteRecords(Optional sDatabase As String = "")
    On Error GoTo Failed
    m_clsTableAccess.DeleteRecords sDatabase
    Exit Sub
Failed:
    g_clsErrorHandling.RaiseError Err.Number, Err.DESCRIPTION
End Sub

Private Sub TableAccess_SetDatabase(sDatabaseKey As String)
    m_clsTableAccess.SetDatabase sDatabaseKey
End Sub

Public Function TableAccess_GetDatabase() As String
    TableAccess_GetDatabase = m_clsTableAccess.GetDatabase()
End Function

Private Sub TableAccess_SetOrderCriteria(sCriteria As String)
    m_clsTableAccess.SetOrderCriteria sCriteria
End Sub

Private Sub TableAccess_SetDuplicateKeys(colDupKeys As Collection)
    m_clsTableAccess.SetDuplicateKeys colDupKeys
End Sub
Private Function TableAccess_GetDuplicateKeys() As Collection
    Set TableAccess_GetDuplicateKeys = m_clsTableAccess.GetDuplicateKeys()
End Function

Private Sub TableAccess_SetCollectionField(sField As String)
    m_clsTableAccess.SetCollectionField sField
End Sub

Private Function TableAccess_GetCollectionField() As String
    TableAccess_GetCollectionField = m_clsTableAccess.GetCollectionField()
End Function

Private Sub TableAccess_ApplyFilter(Optional sSearch As String)
    m_clsTableAccess.ApplyFilter sSearch
End Sub

Private Sub TableAccess_CancelFilter()
    m_clsTableAccess.CancelFilter
End Sub
